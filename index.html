<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Phân tích danh mục - Nomini</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #F1F5F9;
      min-height: 100vh;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    const COIN_PRICES = {
      BTC: 88230, ETH: 2926, BNB: 878, SOL: 124,
      ADA: 0.35, XRP: 1.90, DOGE: 0.12, DOT: 4.50,
      AVAX: 11.70, MATIC: 0.32, LINK: 15.80, UNI: 8.50,
      ATOM: 5.20, LTC: 69.60, USDT: 1.00, USDC: 1.00,
      ARB: 0.45, OP: 1.20, SUI: 1.44, APT: 5.80,
      INJ: 12.50, TIA: 3.20, SEI: 0.25, NEAR: 3.50,
      FTM: 0.45, ALGO: 0.22, VET: 0.025,
      AAVE: 185, MKR: 1250, CRV: 0.55,
      FET: 1.10, RNDR: 4.80, GRT: 0.14, FIL: 3.80,
      HBAR: 0.11, EOS: 0.55, XLM: 0.21, TRX: 0.30,
      SHIB: 0.000012, PEPE: 0.0000008, WIF: 0.85, BONK: 0.000015,
    };

    const formatUSD = (value) => {
      if (value >= 1000) {
        return '$' + value.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
      } else if (value >= 1) {
        return '$' + value.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      } else {
        return '$' + value.toFixed(6);
      }
    };

    const COLORS = ['#0891B2', '#8B5CF6', '#F59E0B', '#10B981', '#EC4899', '#6366F1'];

    // Component Line Chart cho tổng danh mục
    function TotalLineChart({ data }) {
      const chartRef = useRef(null);
      const canvasRef = useRef(null);

      useEffect(() => {
        if (chartRef.current) {
          chartRef.current.destroy();
        }

        const ctx = canvasRef.current.getContext('2d');
        chartRef.current = new Chart(ctx, {
          type: 'line',
          data: {
            labels: ['Kịch bản 1', 'Hiện tại', 'Kịch bản 2'],
            datasets: [{
              label: 'Giá trị danh mục',
              data: [data.totalS1, data.totalCurrent, data.totalS2],
              borderColor: '#0891B2',
              backgroundColor: 'rgba(8, 145, 178, 0.1)',
              borderWidth: 3,
              pointBackgroundColor: ['#DC2626', '#0891B2', '#16A34A'],
              pointBorderColor: ['#DC2626', '#0891B2', '#16A34A'],
              pointRadius: 8,
              pointHoverRadius: 10,
              fill: true,
              tension: 0.3
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false },
              tooltip: {
                callbacks: {
                  label: (context) => formatUSD(context.raw)
                }
              }
            },
            scales: {
              y: {
                beginAtZero: false,
                ticks: {
                  callback: (value) => '$' + (value/1000).toFixed(1) + 'k'
                }
              }
            }
          }
        });

        return () => {
          if (chartRef.current) {
            chartRef.current.destroy();
          }
        };
      }, [data]);

      return <canvas ref={canvasRef} />;
    }

    // Component Line Chart cho từng coin (%)
    function CoinLineChart({ analysis }) {
      const chartRef = useRef(null);
      const canvasRef = useRef(null);

      useEffect(() => {
        if (chartRef.current) {
          chartRef.current.destroy();
        }

        const ctx = canvasRef.current.getContext('2d');
        
        const datasets = analysis.map((item, i) => ({
          label: item.coin,
          data: [item.scenario1Change, 0, item.scenario2Change],
          borderColor: COLORS[i % COLORS.length],
          backgroundColor: COLORS[i % COLORS.length],
          borderWidth: 2,
          pointRadius: 6,
          pointHoverRadius: 8,
          fill: false,
          tension: 0.3
        }));

        chartRef.current = new Chart(ctx, {
          type: 'line',
          data: {
            labels: ['Kịch bản 1', 'Hiện tại', 'Kịch bản 2'],
            datasets: datasets
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { 
                position: 'bottom',
                labels: { usePointStyle: true, padding: 20 }
              },
              tooltip: {
                callbacks: {
                  label: (context) => context.dataset.label + ': ' + context.raw.toFixed(1) + '%'
                }
              }
            },
            scales: {
              y: {
                ticks: {
                  callback: (value) => value + '%'
                }
              }
            }
          }
        });

        return () => {
          if (chartRef.current) {
            chartRef.current.destroy();
          }
        };
      }, [analysis]);

      return <canvas ref={canvasRef} />;
    }

    function App() {
      const [step, setStep] = useState(0);
      const [coins, setCoins] = useState([]);
      const [tableData, setTableData] = useState([]);
      const [results, setResults] = useState(null);
      const [coinInput, setCoinInput] = useState('');
      const [error, setError] = useState('');

      const handleCoinSubmit = () => {
        const inputCoins = coinInput.toUpperCase().split(',').map(c => c.trim()).filter(c => c);
        const validCoins = inputCoins.filter(c => COIN_PRICES[c]);
        const invalidCoins = inputCoins.filter(c => !COIN_PRICES[c]);

        if (validCoins.length === 0) {
          setError('Không tìm thấy coin hợp lệ. Vui lòng nhập lại.');
          return;
        }

        if (invalidCoins.length > 0) {
          setError(`Không hỗ trợ: ${invalidCoins.join(', ')}. Tiếp tục với: ${validCoins.join(', ')}`);
        } else {
          setError('');
        }

        setCoins(validCoins);
        setTableData(validCoins.map(coin => ({
          coin,
          currentPrice: COIN_PRICES[coin],
          quantity: '',
          scenario1: '',
          scenario2: ''
        })));
        setStep(1);
      };

      const updateTableData = (index, field, value) => {
        const newData = [...tableData];
        newData[index][field] = value;
        setTableData(newData);
      };

      const handleAnalyze = () => {
        const isValid = tableData.every(row => 
          row.quantity && row.scenario1 && row.scenario2 &&
          !isNaN(parseFloat(row.quantity)) && 
          !isNaN(parseFloat(row.scenario1)) && 
          !isNaN(parseFloat(row.scenario2))
        );

        if (!isValid) {
          setError('Vui lòng điền đầy đủ số lượng và giá kịch bản cho tất cả coin.');
          return;
        }

        setError('');

        const analysis = tableData.map(row => {
          const qty = parseFloat(row.quantity);
          const currentPrice = row.currentPrice;
          const s1Price = parseFloat(row.scenario1);
          const s2Price = parseFloat(row.scenario2);

          const currentValue = qty * currentPrice;
          const s1Value = qty * s1Price;
          const s2Value = qty * s2Price;

          const s1Change = ((s1Price - currentPrice) / currentPrice) * 100;
          const s2Change = ((s2Price - currentPrice) / currentPrice) * 100;

          return {
            coin: row.coin,
            quantity: qty,
            currentPrice,
            scenario1Price: s1Price,
            scenario2Price: s2Price,
            currentValue,
            scenario1Value: s1Value,
            scenario2Value: s2Value,
            scenario1Change: s1Change,
            scenario2Change: s2Change
          };
        });

        const totalCurrent = analysis.reduce((sum, a) => sum + a.currentValue, 0);
        const totalS1 = analysis.reduce((sum, a) => sum + a.scenario1Value, 0);
        const totalS2 = analysis.reduce((sum, a) => sum + a.scenario2Value, 0);

        const totalS1Change = ((totalS1 - totalCurrent) / totalCurrent) * 100;
        const totalS2Change = ((totalS2 - totalCurrent) / totalCurrent) * 100;

        const risk = totalCurrent - totalS1;
        const reward = totalS2 - totalCurrent;
        const riskRewardRatio = risk > 0 ? (reward / risk).toFixed(2) : 'N/A';

        setResults({
          analysis,
          totalCurrent,
          totalS1,
          totalS2,
          totalS1Change,
          totalS2Change,
          risk,
          reward,
          riskRewardRatio
        });

        setStep(2);
      };

      const handleReset = () => {
        setStep(0);
        setCoins([]);
        setTableData([]);
        setResults(null);
        setCoinInput('');
        setError('');
      };

      return (
        <div style={{
          maxWidth: '800px',
          margin: '0 auto',
          padding: '20px',
          minHeight: '100vh'
        }}>
          {/* Header */}
          <div style={{
            background: 'linear-gradient(135deg, #0891B2 0%, #0E7490 100%)',
            borderRadius: '16px',
            padding: '24px',
            marginBottom: '20px',
            color: 'white',
            textAlign: 'center'
          }}>
            <h1 style={{ fontSize: '24px', fontWeight: 'bold', marginBottom: '8px' }}>
              Phân tích danh mục đầu tư
            </h1>
            <p style={{ fontSize: '14px', opacity: 0.9 }}>Nomini - Workshop Tool</p>
          </div>

          {/* Step 0: Nhập coin */}
          {step === 0 && (
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '24px',
              boxShadow: '0 2px 8px rgba(0,0,0,0.08)'
            }}>
              <h2 style={{ fontSize: '18px', fontWeight: '600', marginBottom: '16px', color: '#1E293B' }}>
                Bước 1: Nhập danh sách coin
              </h2>
              <p style={{ fontSize: '14px', color: '#64748B', marginBottom: '16px' }}>
                Nhập các mã coin, phân tách bằng dấu phẩy. Ví dụ: BTC, ETH, SOL
              </p>
              <input
                type="text"
                value={coinInput}
                onChange={(e) => setCoinInput(e.target.value)}
                onKeyPress={(e) => e.key === 'Enter' && handleCoinSubmit()}
                placeholder="BTC, ETH, SOL, ARB..."
                style={{
                  width: '100%',
                  padding: '14px 16px',
                  fontSize: '16px',
                  border: '2px solid #E2E8F0',
                  borderRadius: '12px',
                  outline: 'none',
                  marginBottom: '12px'
                }}
              />
              {error && (
                <p style={{ fontSize: '13px', color: '#DC2626', marginBottom: '12px' }}>{error}</p>
              )}
              <button
                onClick={handleCoinSubmit}
                style={{
                  width: '100%',
                  padding: '14px',
                  background: '#0891B2',
                  color: 'white',
                  border: 'none',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontWeight: '600',
                  cursor: 'pointer'
                }}
              >
                Tiếp tục
              </button>
            </div>
          )}

          {/* Step 1: Bảng nhập liệu */}
          {step === 1 && (
            <div style={{
              background: 'white',
              borderRadius: '16px',
              padding: '24px',
              boxShadow: '0 2px 8px rgba(0,0,0,0.08)'
            }}>
              <h2 style={{ fontSize: '18px', fontWeight: '600', marginBottom: '8px', color: '#1E293B' }}>
                Bước 2: Điền thông tin
              </h2>
              <p style={{ fontSize: '14px', color: '#64748B', marginBottom: '20px' }}>
                Nhập số lượng và giá cho 2 kịch bản
              </p>

              <div style={{ overflowX: 'auto' }}>
                <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '14px' }}>
                  <thead>
                    <tr style={{ background: '#F8FAFC' }}>
                      <th style={{ padding: '12px 8px', textAlign: 'left', fontWeight: '600', color: '#64748B', borderBottom: '2px solid #E2E8F0' }}>Coin</th>
                      <th style={{ padding: '12px 8px', textAlign: 'right', fontWeight: '600', color: '#64748B', borderBottom: '2px solid #E2E8F0' }}>Giá hiện tại</th>
                      <th style={{ padding: '12px 8px', textAlign: 'center', fontWeight: '600', color: '#64748B', borderBottom: '2px solid #E2E8F0' }}>Số lượng</th>
                      <th style={{ padding: '12px 8px', textAlign: 'center', fontWeight: '600', color: '#64748B', borderBottom: '2px solid #E2E8F0' }}>Kịch bản 1</th>
                      <th style={{ padding: '12px 8px', textAlign: 'center', fontWeight: '600', color: '#64748B', borderBottom: '2px solid #E2E8F0' }}>Kịch bản 2</th>
                    </tr>
                  </thead>
                  <tbody>
                    {tableData.map((row, index) => (
                      <tr key={row.coin} style={{ borderBottom: '1px solid #F1F5F9' }}>
                        <td style={{ padding: '12px 8px' }}>
                          <span style={{
                            background: COLORS[index % COLORS.length],
                            color: 'white',
                            padding: '4px 10px',
                            borderRadius: '6px',
                            fontSize: '13px',
                            fontWeight: '600'
                          }}>{row.coin}</span>
                        </td>
                        <td style={{ padding: '12px 8px', textAlign: 'right', color: '#64748B' }}>
                          {formatUSD(row.currentPrice)}
                        </td>
                        <td style={{ padding: '8px 4px' }}>
                          <input
                            type="text"
                            value={row.quantity}
                            onChange={(e) => updateTableData(index, 'quantity', e.target.value)}
                            placeholder="0.00"
                            style={{
                              width: '80px',
                              padding: '8px',
                              border: '1px solid #E2E8F0',
                              borderRadius: '8px',
                              textAlign: 'center',
                              fontSize: '14px'
                            }}
                          />
                        </td>
                        <td style={{ padding: '8px 4px' }}>
                          <input
                            type="text"
                            value={row.scenario1}
                            onChange={(e) => updateTableData(index, 'scenario1', e.target.value)}
                            placeholder="Giá KB1"
                            style={{
                              width: '90px',
                              padding: '8px',
                              border: '1px solid #E2E8F0',
                              borderRadius: '8px',
                              textAlign: 'center',
                              fontSize: '14px'
                            }}
                          />
                        </td>
                        <td style={{ padding: '8px 4px' }}>
                          <input
                            type="text"
                            value={row.scenario2}
                            onChange={(e) => updateTableData(index, 'scenario2', e.target.value)}
                            placeholder="Giá KB2"
                            style={{
                              width: '90px',
                              padding: '8px',
                              border: '1px solid #E2E8F0',
                              borderRadius: '8px',
                              textAlign: 'center',
                              fontSize: '14px'
                            }}
                          />
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              {error && (
                <p style={{ fontSize: '13px', color: '#DC2626', marginTop: '12px' }}>{error}</p>
              )}

              <div style={{ display: 'flex', gap: '12px', marginTop: '20px' }}>
                <button
                  onClick={() => setStep(0)}
                  style={{
                    flex: 1,
                    padding: '14px',
                    background: '#F1F5F9',
                    color: '#64748B',
                    border: 'none',
                    borderRadius: '12px',
                    fontSize: '16px',
                    fontWeight: '600',
                    cursor: 'pointer'
                  }}
                >
                  Quay lại
                </button>
                <button
                  onClick={handleAnalyze}
                  style={{
                    flex: 2,
                    padding: '14px',
                    background: '#0891B2',
                    color: 'white',
                    border: 'none',
                    borderRadius: '12px',
                    fontSize: '16px',
                    fontWeight: '600',
                    cursor: 'pointer'
                  }}
                >
                  Phân tích
                </button>
              </div>
            </div>
          )}

          {/* Step 2: Kết quả */}
          {step === 2 && results && (
            <div>
              {/* Tổng quan */}
              <div style={{
                background: 'white',
                borderRadius: '16px',
                padding: '24px',
                marginBottom: '16px',
                boxShadow: '0 2px 8px rgba(0,0,0,0.08)'
              }}>
                <h2 style={{ fontSize: '14px', fontWeight: '600', marginBottom: '16px', color: '#64748B', letterSpacing: '0.5px' }}>
                  DANH MỤC HIỆN TẠI
                </h2>
                <div style={{ fontSize: '32px', fontWeight: 'bold', color: '#1E293B', marginBottom: '20px' }}>
                  {formatUSD(results.totalCurrent)}
                </div>

                {results.analysis.map((item, i) => (
                  <div key={item.coin} style={{
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'center',
                    padding: '12px 0',
                    borderBottom: i < results.analysis.length - 1 ? '1px solid #F1F5F9' : 'none'
                  }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                      <span style={{
                        background: COLORS[i % COLORS.length],
                        color: 'white',
                        padding: '4px 10px',
                        borderRadius: '6px',
                        fontSize: '12px',
                        fontWeight: '600'
                      }}>{item.coin}</span>
                      <span style={{ color: '#64748B', fontSize: '13px' }}>
                        {item.quantity} × {formatUSD(item.currentPrice)}
                      </span>
                    </div>
                    <div style={{ textAlign: 'right' }}>
                      <div style={{ fontWeight: '600', color: '#1E293B' }}>{formatUSD(item.currentValue)}</div>
                      <div style={{ fontSize: '12px', color: '#64748B' }}>
                        {((item.currentValue / results.totalCurrent) * 100).toFixed(1)}%
                      </div>
                    </div>
                  </div>
                ))}
              </div>

              {/* Line Chart - Tổng danh mục */}
              <div style={{
                background: 'white',
                borderRadius: '16px',
                padding: '24px',
                marginBottom: '16px',
                boxShadow: '0 2px 8px rgba(0,0,0,0.08)'
              }}>
                <h2 style={{ fontSize: '14px', fontWeight: '600', marginBottom: '20px', color: '#64748B', letterSpacing: '0.5px' }}>
                  BIẾN ĐỘNG TỔNG DANH MỤC
                </h2>

                <div style={{ height: '250px', marginBottom: '20px' }}>
                  <TotalLineChart data={results} />
                </div>

                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '12px' }}>
                  <div style={{ background: '#FEF2F2', borderRadius: '12px', padding: '16px', textAlign: 'center' }}>
                    <div style={{ fontSize: '12px', color: '#DC2626', marginBottom: '4px' }}>Kịch bản 1</div>
                    <div style={{ fontSize: '18px', fontWeight: 'bold', color: '#DC2626' }}>{formatUSD(results.totalS1)}</div>
                    <div style={{ fontSize: '13px', color: '#DC2626' }}>{results.totalS1Change.toFixed(1)}%</div>
                  </div>
                  <div style={{ background: '#F0FDFA', borderRadius: '12px', padding: '16px', textAlign: 'center' }}>
                    <div style={{ fontSize: '12px', color: '#0891B2', marginBottom: '4px' }}>Hiện tại</div>
                    <div style={{ fontSize: '18px', fontWeight: 'bold', color: '#0891B2' }}>{formatUSD(results.totalCurrent)}</div>
                    <div style={{ fontSize: '13px', color: '#0891B2' }}>Cơ sở</div>
                  </div>
                  <div style={{ background: '#F0FDF4', borderRadius: '12px', padding: '16px', textAlign: 'center' }}>
                    <div style={{ fontSize: '12px', color: '#16A34A', marginBottom: '4px' }}>Kịch bản 2</div>
                    <div style={{ fontSize: '18px', fontWeight: 'bold', color: '#16A34A' }}>{formatUSD(results.totalS2)}</div>
                    <div style={{ fontSize: '13px', color: '#16A34A' }}>+{results.totalS2Change.toFixed(1)}%</div>
                  </div>
                </div>
              </div>

              {/* Line Chart - Từng coin */}
              <div style={{
                background: 'white',
                borderRadius: '16px',
                padding: '24px',
                marginBottom: '16px',
                boxShadow: '0 2px 8px rgba(0,0,0,0.08)'
              }}>
                <h2 style={{ fontSize: '14px', fontWeight: '600', marginBottom: '20px', color: '#64748B', letterSpacing: '0.5px' }}>
                  BIẾN ĐỘNG TỪNG COIN (%)
                </h2>

                <div style={{ height: '280px', marginBottom: '20px' }}>
                  <CoinLineChart analysis={results.analysis} />
                </div>

                {/* Bảng chi tiết */}
                <div style={{ overflowX: 'auto' }}>
                  <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '13px' }}>
                    <thead>
                      <tr style={{ background: '#F8FAFC' }}>
                        <th style={{ padding: '10px 8px', textAlign: 'left', fontWeight: '600', color: '#64748B' }}>Coin</th>
                        <th style={{ padding: '10px 8px', textAlign: 'right', fontWeight: '600', color: '#DC2626' }}>KB1</th>
                        <th style={{ padding: '10px 8px', textAlign: 'right', fontWeight: '600', color: '#64748B' }}>Hiện tại</th>
                        <th style={{ padding: '10px 8px', textAlign: 'right', fontWeight: '600', color: '#16A34A' }}>KB2</th>
                      </tr>
                    </thead>
                    <tbody>
                      {results.analysis.map((item, i) => (
                        <tr key={item.coin} style={{ borderBottom: '1px solid #F1F5F9' }}>
                          <td style={{ padding: '10px 8px' }}>
                            <span style={{
                              background: COLORS[i % COLORS.length],
                              color: 'white',
                              padding: '2px 8px',
                              borderRadius: '4px',
                              fontSize: '12px',
                              fontWeight: '600'
                            }}>{item.coin}</span>
                          </td>
                          <td style={{ padding: '10px 8px', textAlign: 'right' }}>
                            <div style={{ color: '#DC2626' }}>{formatUSD(item.scenario1Value)}</div>
                            <div style={{ fontSize: '11px', color: '#DC2626' }}>({item.scenario1Change.toFixed(0)}%)</div>
                          </td>
                          <td style={{ padding: '10px 8px', textAlign: 'right' }}>
                            <div style={{ fontWeight: '600' }}>{formatUSD(item.currentValue)}</div>
                          </td>
                          <td style={{ padding: '10px 8px', textAlign: 'right' }}>
                            <div style={{ color: '#16A34A' }}>{formatUSD(item.scenario2Value)}</div>
                            <div style={{ fontSize: '11px', color: '#16A34A' }}>(+{item.scenario2Change.toFixed(0)}%)</div>
                          </td>
                        </tr>
                      ))}
                      <tr style={{ background: '#F8FAFC', fontWeight: '600' }}>
                        <td style={{ padding: '10px 8px' }}>TỔNG</td>
                        <td style={{ padding: '10px 8px', textAlign: 'right', color: '#DC2626' }}>{formatUSD(results.totalS1)}</td>
                        <td style={{ padding: '10px 8px', textAlign: 'right' }}>{formatUSD(results.totalCurrent)}</td>
                        <td style={{ padding: '10px 8px', textAlign: 'right', color: '#16A34A' }}>{formatUSD(results.totalS2)}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              {/* So sánh 2 kịch bản */}
              <div style={{
                background: 'white',
                borderRadius: '16px',
                padding: '24px',
                marginBottom: '16px',
                boxShadow: '0 2px 8px rgba(0,0,0,0.08)'
              }}>
                <h2 style={{ fontSize: '14px', fontWeight: '600', marginBottom: '16px', color: '#64748B', letterSpacing: '0.5px' }}>
                  SO SÁNH 2 KỊCH BẢN
                </h2>

                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '12px' }}>
                  <div style={{
                    background: results.totalS1Change >= 0 ? '#F0FDF4' : '#FEF2F2',
                    borderRadius: '12px',
                    padding: '20px',
                    textAlign: 'center'
                  }}>
                    <div style={{ fontSize: '12px', color: '#64748B', marginBottom: '8px' }}>Kịch bản 1</div>
                    <div style={{ fontSize: '24px', fontWeight: 'bold', color: results.totalS1Change >= 0 ? '#16A34A' : '#DC2626' }}>
                      {results.totalS1Change >= 0 ? '+' : ''}{formatUSD(results.totalS1 - results.totalCurrent)}
                    </div>
                    <div style={{ fontSize: '13px', color: results.totalS1Change >= 0 ? '#16A34A' : '#DC2626', marginTop: '4px' }}>
                      {results.totalS1Change >= 0 ? '+' : ''}{results.totalS1Change.toFixed(1)}%
                    </div>
                  </div>

                  <div style={{
                    background: results.totalS2Change >= 0 ? '#F0FDF4' : '#FEF2F2',
                    borderRadius: '12px',
                    padding: '20px',
                    textAlign: 'center'
                  }}>
                    <div style={{ fontSize: '12px', color: '#64748B', marginBottom: '8px' }}>Kịch bản 2</div>
                    <div style={{ fontSize: '24px', fontWeight: 'bold', color: results.totalS2Change >= 0 ? '#16A34A' : '#DC2626' }}>
                      {results.totalS2Change >= 0 ? '+' : ''}{formatUSD(results.totalS2 - results.totalCurrent)}
                    </div>
                    <div style={{ fontSize: '13px', color: results.totalS2Change >= 0 ? '#16A34A' : '#DC2626', marginTop: '4px' }}>
                      {results.totalS2Change >= 0 ? '+' : ''}{results.totalS2Change.toFixed(1)}%
                    </div>
                  </div>

                  <div style={{
                    background: '#F8FAFC',
                    borderRadius: '12px',
                    padding: '20px',
                    textAlign: 'center'
                  }}>
                    <div style={{ fontSize: '12px', color: '#64748B', marginBottom: '8px' }}>Chênh lệch</div>
                    <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#1E293B' }}>
                      {formatUSD(Math.abs(results.totalS2 - results.totalS1))}
                    </div>
                    <div style={{ fontSize: '13px', color: '#64748B', marginTop: '4px' }}>
                      {Math.abs(results.totalS2Change - results.totalS1Change).toFixed(1)}%
                    </div>
                  </div>
                </div>
              </div>

              {/* Nút làm lại */}
              <button
                onClick={handleReset}
                style={{
                  width: '100%',
                  padding: '16px',
                  background: '#1E293B',
                  color: 'white',
                  border: 'none',
                  borderRadius: '12px',
                  fontSize: '16px',
                  fontWeight: '600',
                  cursor: 'pointer'
                }}
              >
                Phân tích danh mục mới
              </button>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
